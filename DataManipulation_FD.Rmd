---
title: "Data Manipulation in R"
output:
  html_document:
    df_print: paged
---

Load the required packages

```{r warning=FALSE}
suppressPackageStartupMessages({
    library(dplyr, quietly = T)
    library(lubridate, quietly = T)
})
```


Let's read the data set into R studio environment

```{r LoadingDataSet}
setwd("F:\\E-learn\\Jigsaw\\Intro to R\\Data Manipulation")
fd=read.csv("FlightDelays.csv")
class(fd)
dim(fd)
str(fd)
summary(fd)
```


Variables `weather`, `dayweek` and `daymonth` are stored as numrical variables. These are supposed to be categorical variables. Let's convert them into categorical variables 

```{r}
fd$weather=as.factor(fd$weather)
fd$dayweek=as.factor(fd$dayweek)
fd$daymonth=as.factor(fd$daymonth)
str(fd)

```


```{r}
head(fd$date)
str(fd$date)
```

Converting the variable `date` into Date format. Looking at the first 6 and last 6 observations in the date column it is clear that the date is of the format mdy Date column is converted into date format using the `lubridate()` library.


```{r}
fd$date=mdy(fd$date)

head(fd$date)

str(fd$date)
```


**Q1.Find out the number of delayed flights for all weekdays**

```{r}
fd%>%filter(delay=="delayed"&weekdays(date)!="Saturday"&weekdays(date)!="Sunday")%>%nrow()
```


**Q2 Find the average distance, total distance, and count for all delayed flights on Friday**


```{r}
fd%>%filter(weekdays(date)=="Friday" & delay=="delayed")%>%summarize(mean(distance),sum(distance),length(distance))
```


**Q3 Find out how many flights were on time on Week days and Weekends (Consider Saturday and Sunday as weekends)**


```{r}
fd%>%filter(delay=="ontime",weekdays(date)!="Saturday"&weekdays(date)!="Sunday")%>%nrow()# number of delayed flights on weekdays

fd%>%filter(delay=="ontime",weekdays(date)=="Saturday"|weekdays(date)=="Sunday")%>%nrow()# number of delayed flights on weekends
```


**Q4 Find out the number of flights for each destination across all weekdays**

```{r}
table(weekdays(fd$date),fd$dest)
```


**Q5 Find out the number of times weather was bad across all weekdays. (1 indicates bad weather)**


```{r}
fd%>%filter(weather==1)%>%group_by(dayweek)%>%summarise(n=n())
```

